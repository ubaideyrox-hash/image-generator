<div class="container">
    <div *ngIf="loader==true">
        <div class="site-loader" id="site-loader">
            <span class="loader-spin"></span>
        </div>
    </div>
    <div class="search-display-container">
        <span class="p-input-icon-right search-input" [ngClass]="isFullInput ? 'input-span-full-width': ''">
            <i class="pi pi-search icon-color" (click)="toggleInput(true)"></i>
            <input type="text" (input)="search($event)" pInputText placeholder="Search in All items" class="input-search">
        </span>
    </div>

    <div class="container2" (click)="toggleInput(false)">
        <div class="margin-top">
            <div>
                <h5>All Items</h5>
            </div>

            <!-- <div class="n-items">
                <p> 10 Items &nbsp; | Per Page : <span class="dropdown-container"><p-dropdown [options]="itemsCount"
                            [(ngModel)]="selectedCount" optionLabel="count" optionValue="count"></p-dropdown></span>
                </p>

            </div> -->
        </div>

        <div style="display: flex; align-items: center; height: 40px;">
            <!-- <button pButton type="button" label="+ Add Folder" ></button>    -->
            <div style="background-color: white; padding: 8px;margin: 5px; border-radius: 3px;">
                <i class="pi pi-th-large
                " style="color: black;"></i>
            </div>

            <div style="background-color: white; padding: 8px;margin: 5px; border-radius: 3px;" (click)="getUsers()">
                <i class="pi pi-sync"> </i>

            </div>
        </div>
    </div>
    <p-galleria [value]="[viewImage]" [(visible)]="ShowImage" [(activeIndex)]="activeIndex"
        [containerStyle]="{'max-width': '850px'}" [fullScreen]="true" [showThumbnails]="false" [baseZIndex]="100000">
        <ng-template pTemplate="item" let-item>
            <img [src]="item.image" style="width: 100%; display: block;" />
        </ng-template>
        <ng-template pTemplate="thumbnail" let-item>
            <div class="grid grid-nogutter justify-content-center">
                <img [src]="item.image" style="display: block;" />
            </div>
        </ng-template>
    </p-galleria>
    <p-table [value]="allRecords" sortMode="multiple" [(selection)]="dtSelectedRows" [rows]="10" [showCurrentPageReport]="true" [paginator]="true" [rowsPerPageOptions]="[10,20,50,100,{showAll:'All'}]" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" [paginator]="true"
        [tableStyle]="{'width': '100%', 'border-bottom-spacing':'10px'}">
        <ng-template pTemplate="header">
            <tr>
                <th style=" background: none;">
                    <p-tableHeaderCheckbox (click)="checkVal()"></p-tableHeaderCheckbox>
                </th>
                <th pSortableColumn="username" style=" background: none; ">User Name <p-sortIcon field="username"></p-sortIcon></th>
                <th pSortableColumn="email" style=" background: none;">Email<p-sortIcon field="email"></p-sortIcon></th>
                <!-- <th style=" background: none;">Tags <p-sortIcon field="tags"></p-sortIcon></th> -->
                <th style=" background: none;">Actions </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-user>
            <tr>
                <td>
                    <p-tableCheckbox [value]="user" (click)="checkVal()"></p-tableCheckbox>
                </td>
                <td>
                    <div style="display:flex; align-items: center;cursor: pointer;">

                        {{user.username}}
                    </div>
                </td>
                <!-- <td>{{imageInfo.createdAt | date}}</td> -->
                <td>{{user.email}}</td>
                <td>
                    <!-- <p-menubar (click) ="Actions($event,imageInfo.name)"  [baseZIndex]="10000" [autoZIndex]="false" [baseZIndex]="10000" [autoZIndex]="false" [model]="global.items"></p-menubar> -->
                    <p-overlayPanel #op>
                        <ng-template pTemplate>
                            <ul class="actions-ul">
                                <li class="p-2 list-item" (click)="editUser(user)">
                                    <i class="pi pi-pencil" style="font-size: 1em"></i>
                                    <span class="ml-2">Edit</span>

                                </li>
                                <!-- <li class="p-2 list-item">
                                    <i class="pi pi-copy" style="font-size: 1em"></i>
                                    <span class="ml-2">Duplicate</span>

                                </li> -->
                                <li class="p-2 list-item" (click)="deleteUser(user._id)">
                                    <i class="pi pi-trash" style="font-size: 1em; color: #DD5A43;"></i>
                                    <span class="ml-2" style="color: #DD5A43;">Delete</span>
                                </li>
                            </ul>
                        </ng-template>
                    </p-overlayPanel>
                    <button class="three-dots-btn" type="text" pButton label="..." (click)="op.toggle($event)"></button>
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage" let-columns>
            <tr>
              <td [attr.colspan]="30" class="text-center">
                <strong *ngIf="noRecord">No records found</strong>
              </td>
            </tr>
          </ng-template>
    </p-table>

    <!-- <div class="footer">
        <button pButton type="button" label="Add Image" (click)="changeAddImageDisplay()"></button>
        <button pButton type="button" label="Actions"></button>
    </div> -->

    <div class="flex" class="bttns">
        <button (click)="changeAddImageDisplay()" pButton type="button" label="Add User"
            class="p-button-warning playlist-btn "></button>

        <!-- <p-menubar [model]="global.actionMenu" class="action-margin-right" style=" background-color: white; padding: 5px ; border:1px solid black; border-radius: 5px;" ></p-menubar> -->
        <p-overlayPanel #op>
            <ng-template pTemplate>
                <ul class="actions-ul">
                    <!-- <li class="p-2 list-item">
                        <i class="pi pi-pencil" style="font-size: 1em"></i>
                        <span class="ml-2">Edit</span>

                    </li>
                    <li class="p-2 list-item">
                        <i class="pi pi-copy" style="font-size: 1em"></i>
                        <span class="ml-2">Duplicate</span>

                    </li> -->
                    <li class="p-2 list-item">
                        <i class="pi pi-trash" style="font-size: 1em; color: #DD5A43;"></i>
                        <span class="ml-2" (click)="DeleteUsers()" style="color: #DD5A43;">Delete</span>
                    </li>
                </ul>
            </ng-template>
        </p-overlayPanel>
        <button class="action-footer-btn" [disabled]=actionButton type="text" pButton label="Actions" (click)="op.toggle($event)"></button>
    </div>




    <p-dialog [(visible)]="displayAddImageModal" position="top">
        <ng-template pTemplate="header" >
            <span class="header">{{button}}</span>
        </ng-template>
        <span layout="row">
            <hr flex />
        </span>
        <div class="formgrid grid">
            <div class="field col-6">
                <label>Username</label>
                <input type="text" [(ngModel)]="userName" pInputText class="w-full" placeholder="username" />
            </div>
            <!-- <div class="field col-6">
                <label>Lastname</label>
                <input type="text" [(ngModel)]="lastname" pInputText class="w-full" placeholder="lastname" />
            </div> -->
            <div class="field col-6">
                <label>Email</label>
                <input type="text" [(ngModel)]="email" pInputText class="w-full" placeholder="email" />
            </div>
            <div class="field col-6">
                <label>Password</label>
                <input [type]="showPassword ? 'text' : 'password'" [(ngModel)]="password" pInputText class="w-full" placeholder="password"  />
                <div class="showhide">
                    <i alt="show" class="pi pi-eye"
                    (click)="showPassword = !showPassword"
                    [class.hide]="showPassword"></i>
                    <i alt="hide" class="pi pi-eye-slash"
                    (click)="showPassword = !showPassword"
                    [class.hide]="!showPassword"></i>
                  </div>
            </div>
            <div class="field col-6">
                <label>Confirm Password</label>
                <input [type]="showConfirmPassword ? 'text' : 'password'" [(ngModel)]="confirm_password" (input)="Validation()" pInputText class="w-full" placeholder="confirm password" />
                <div class="showhide">
                    <i alt="show" class="pi pi-eye"
                    (click)="showConfirmPassword = !showConfirmPassword"
                    [class.hide]="showConfirmPassword"></i>
                    <i alt="hide" class="pi pi-eye-slash"
                    (click)="showConfirmPassword = !showConfirmPassword"
                    [class.hide]="!showConfirmPassword"></i>
                  </div>
                <ng-container *ngIf="this.is_Confirm">
                    <span style="color: red;">Password Confirmation must match password</span>
                </ng-container>
            </div>
            <div class="field col-2">
                <label>isAdmin?</label><br>
                <!-- <textarea [rows]="5" [cols]="30" pInputTextarea class="textarea-p"></textarea> -->
                <p-checkbox [(ngModel)]="isadmin" [binary]="true"></p-checkbox>
            </div>
        </div>
        <hr flex />
        <!-- <div style="width: 100%; border: 1px dotted grey;" *ngIf="isImage">
            <p-fileUpload name="myfile[]"></p-fileUpload>
        </div> -->

        <div style="margin-top: 14px; display: flex; justify-content: right; ">
            <button type="button" pButton (click)="changeAddImageDisplay()">Cancel</button>
            <button type="button" pButton style="margin-left: 10px;" (click)="createUser()">{{userId?'Update':'Create'}}</button>
        </div>
    </p-dialog>
</div>
